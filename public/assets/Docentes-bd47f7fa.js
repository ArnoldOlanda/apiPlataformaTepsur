import{e as O,r as p,g as w,ai as U,aj as P,ae as z,s as C,o as E,b as a,y as G,B as j,j as v,q as H,l as I}from"./index-b05c3593.js";import{a as J,d as K,e as Q,c as V}from"./teacher.service-ca2ba6d0.js";import{g as X}from"./GlobalAlerts-e291f7f6.js";import{C as R}from"./CustomActionCRUD-56f80e1a.js";/* empty css               */import{S as Y}from"./SelectCustom-ab67c468.js";import{b as Z,c as $,M as ee,D as te}from"./TextfieldsTools-ddad1e93.js";import{T as ae}from"./Tooltip-8a46e05f.js";import{L as _}from"./LoadingButton-caa486e8.js";import{P as oe}from"./Page-87bac860.js";import{T as re}from"./TableCRUDMini-8ef25830.js";import{C as ne}from"./CustomSelectSearchLabel-0730f57a.js";import{E as se}from"./Edit-18203eee.js";import{D as ie}from"./Delete-e33b6966.js";import"./MenuItem-d8a67f6c.js";import"./CircularProgress-eeae7465.js";import"./RowCRUD-b35830b8.js";import"./TableRow-52fc41de.js";import"./TableContainer-10b5223d.js";import"./TableHead-f4539647.js";import"./Autocomplete-7a426b1a.js";const ce=(g={})=>{const t=O(),[c,m]=p.useState(g),[d,n]=p.useState([]),{sedes:i}=w(o=>o.utilities),{token:u}=w(o=>o.user),{createAlert:b,editAlert:x,deleteAlert:l}=X();return{...c,formState:c,setFormState:m,onInputChange:({target:o})=>{const{name:r,value:s}=o;m({...c,[r]:s})},onResetForm:()=>{m(g)},onSubmit:async o=>{b("este docente","Docente Registrado",async()=>{try{t(C());const r=await V({...c,token:u});n([...d,r]),t(E())}catch(r){throw r}},o)},getListTeachers:async o=>{try{t(U());const r=await J(u,o);return n(r),t(P()),r}catch(r){z(r),t(P())}},data:d,sedes:i,onDeleteTeacher:(o,r)=>{l("este docente","Docente Eliminado",async()=>{try{t(C());const s=await K(u,o);n([...d.filter(f=>f.uuid!==s.uuid)]),t(E())}catch(s){throw s}},r)},onEditTeacher:(o,r)=>{x("este docente",async()=>{try{t(C());const s=await Q({...c,uuid:o,token:u});n([...d.map(f=>f.uuid==s.uuid?{...f,...s}:f)]),t(E())}catch(s){throw s}},r)}}},de=({formTeacher:g,open:t,handleClose:c,isLoading:m,selected:d})=>{const{onInputChange:n,formState:i,onSubmit:u,sedes:b,onEditTeacher:x,setFormState:l}=g,D=b.map(h=>({label:h.nombre,value:h.uuid}));return a(G,{open:t,handleClose:c,title:d?"Editar Docente":"Agregar Docente",children:a(j,{sx:{px:3,pb:3,width:"300px"},children:a("form",{style:{flex:1},onSubmit:h=>{h.preventDefault(),d?x(d,c):u(c)},children:v(j,{sx:le,children:[a(Z,{formState:i,onInputChange:n,setFormState:l}),a($,{formState:i,onInputChange:n,setFormState:l}),a(ee,{formState:i,onInputChange:n,setFormState:l}),a(Y,{required:!0,label:"Sede",name:"sede",value:i.sede,onChange:n,opts:D,disabled:!0}),a(te,{formState:i,onInputChange:n,setFormState:l}),a(ae,{title:i.error?"Corrija todos los errores":"",children:d?a(_,{fullWidth:!0,disabled:i.error,loading:m,type:"submit",variant:"contained",color:"primary",sx:{mt:2,alignSelf:"flex-end"},children:"Editar Docente"}):a(_,{fullWidth:!0,disabled:i.error,loading:m,type:"submit",variant:"contained",color:"primary",sx:{mt:2,alignSelf:"flex-end"},children:"Agregar Docente"})})]})})})})},le={flex:1,display:"flex",flexDirection:"column",gap:"0px 24px",flexWrap:"wrap"},_e=({toggleDrawer:g})=>{const[t,c]=p.useState([]),{isLoading:m,token:d,user:n}=w(e=>e.user),i=e=>e.map(S=>({uuid:S.uuid,nombres:S.nombres,dni:S.dni,apePaterno:S.ape_paterno,apeMaterno:S.ape_materno,sede:S.sede.uuid})),u={token:d,ape_materno:"",ape_paterno:"",dni:"",nombres:"",sede:n.rol?"":n.sede.uuid,edit:!1},b=ce(u),[x,l]=p.useState(null),{formState:D,setFormState:y,onResetForm:h,data:T,getListTeachers:A,onDeleteTeacher:M,sedes:o}=b,[r,s]=p.useState(!1),f=[...o.map(e=>({label:e.nombre,value:e.uuid}))],[L,B]=p.useState(n.rol?o[0].uuid:n.sede.uuid),N=({target:e})=>{e.value!=""&&(A(e.value),B(e.value))},k=()=>{s(!0)},F=()=>{h(),s(!1),l(null)},q=e=>{s(!0),l(t[e].uuid),y({...D,ape_materno:t[e].apeMaterno,ape_paterno:t[e].apePaterno,dni:t[e].dni,nombres:t[e].nombres,sede:t[e].sede})},W=[a(R,{action:e=>{q(e)},children:a(se,{})}),a(R,{action:e=>{M(t[e].uuid,F)},children:a(ie,{})})];return p.useEffect(()=>{A(L);const e=i(T);c(e)},[]),p.useEffect(()=>{const e=i(T);c(e)},[T]),v(oe,{toggleDrawer:g,title:"Docentes",Actions:a(H,{sx:{width:"100px"},variant:"contained",color:"primary",onClick:k,children:" Agregar"}),children:[v(I,{gap:2,children:[a(I,{flexDirection:"row",gap:3,justifyContent:"space-between",alignItems:"center",width:200,children:a(ne,{required:!0,label:"Sede",name:"sede",value:L,onChange:N,options:f})}),a(re,{data:t,headers:ue,dataTypes:me,extraActions:W})]}),a(de,{formTeacher:b,handleClose:F,open:r,isLoading:m,selected:x})]})},me=["dni","nombres","apePaterno","apeMaterno"],ue=[{name:"DNI",align:"center"},{name:"Nombres",align:"center"},{name:"Apellido Paterno",align:"center"},{name:"Apellido Materno",align:"center"}];export{_e as default};
