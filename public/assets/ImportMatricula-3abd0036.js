import{r as h,j as s,b as e,ao as se,l as P,Q as B,n as $,aI as le,S as U,T as Q,B as S,m as z,F as de,g as ce,f as ue,e as pe,q as _}from"./index-b05c3593.js";import{u as me}from"./useMatricula-d95bae7c.js";import{A as he}from"./AddSchedule-c46ae1fc.js";import{g as W}from"./utilities-59a1cf49.js";import{P as fe}from"./Page-87bac860.js";import{S as ge,s as k,a as be,b as xe,c as Ce,d as Se}from"./Step1-49be6760.js";import{S as ve}from"./SelectCustom-ab67c468.js";import{C as T}from"./CustomSelectSearchLabel-0730f57a.js";import{a as J,T as L,b as ye,c as ke}from"./TableRow-52fc41de.js";import{E as De}from"./Edit-18203eee.js";import{D as Ae}from"./Delete-e33b6966.js";import{C as $e}from"./Check-3890cc30.js";import{T as we}from"./TableHead-f4539647.js";import{A as Ee}from"./Add-1cbcdd1e.js";import"./stylesDrag-a0f829b9.js";/* empty css               */import{T as Ie}from"./Tooltip-8a46e05f.js";import{L as Te}from"./LoadingButton-caa486e8.js";import"./schedule.service-5bfabb81.js";import"./GlobalAlerts-e291f7f6.js";import"./specialization.service-3d04622c.js";import"./careers.service-c54b684b.js";import"./ToggleButtonGroup-67aa73a9.js";import"./TextfieldsTools-ddad1e93.js";import"./CircularProgress-eeae7465.js";import"./CustomSelectSearch-f02217ed.js";import"./Autocomplete-7a426b1a.js";import"./MenuItem-d8a67f6c.js";const Le=({module:r,modules:t,moduleNames:a,formState:f,delModule:d,editModule:u})=>{const[p,v]=h.useState(r.nombre!=""),[c,g]=h.useState(""),x=()=>v(!p),i=()=>{r.nombre!=""?x():d(r.uuid)},m=()=>{c!=""?!f.modulos.some(n=>n.uuid==c)||r.nombre!=""?(u(r.uuid,t.find(n=>n.uuid==c)),x()):U.fire({icon:"error",title:"Modulo repetido",showConfirmButton:!1,timer:1e3}):U.fire({icon:"error",title:"Debes elegir un modulo",showConfirmButton:!1,timer:1e3})},y=({target:n})=>{g(n.value)};return h.useEffect(()=>{a.forEach(n=>{if(n.value==r.uuid){g(r.uuid);return}})},[p]),s(J,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e(L,{children:p?e(se,{primary:`${r.nombre}`}):e(T,{required:!0,label:"Modulo",value:c,onChange:y,options:a})}),e(L,{flex:1,align:"right",children:e(P,{flexDirection:"row",alignItems:"center",justifyContent:"flex-end",children:p?s(B,{children:[e($,{onClick:x,children:e(De,{})}),e($,{onClick:()=>d(r.uuid),children:e(Ae,{})})]}):s(B,{children:[e($,{onClick:m,children:e($e,{})}),e($,{onClick:()=>c==""?d(r.uuid):i(),children:e(le,{})})]})})})]})},Me=({formGroup:r})=>{const{formState:t,setFormState:a,modules:f}=r,[d,u]=h.useState([]),p=[...f.map(i=>({label:i.nombre,value:i.uuid}))],v=i=>{a({...t,modulos:[...t.modulos,i]})},c=i=>{a({...t,modulos:[...t.modulos.filter(m=>m.uuid!==i)]})},g=(i,m)=>{const y=t.modulos.map(n=>n.uuid==i?{...n,...m}:n);a({...t,modulos:y})};return s(B,{children:[e(P,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",children:e(Q,{component:"h1",variant:"h6",sx:{textAlign:"left"},children:"Modulos Completados"})}),e(S,{children:s(ye,{size:"small",children:[e(we,{children:s(J,{children:[e(L,{children:"Modulos"}),e(L,{align:"right",children:e($,{onClick:()=>{v({uuid:d,nombre:""}),u(d+1)},sx:{border:"0px dashed black"},children:e(Ee,{})})})]})}),e(ke,{children:t.modulos.length!=0&&t.modulos.map((i,m)=>e(Le,{delModule:c,modules:f,editModule:g,module:i,moduleNames:p,formState:t},`${i.uuid}`))}),t.modulos.length==0&&e("caption",{style:{textAlign:"center"},children:" Agrega modulos con el boton +"})]})})]})},Fe=({formCareer:r,handleOpenAdd:t})=>{const{formState:a,setFormState:f,onInputChange:d,carreras:u,modules:p,getModules:v,schedules:c,sedes:g,getListSchedules:x,loading:i,secretarias:m,speacials:y}=r,[n,b]=h.useState([...p.map(o=>({label:o.nombre,value:o.uuid}))]),M=[...y.map(o=>({label:o.nombre,value:o.uuid}))],D=[...u.map(o=>({label:o.nombre,value:o.uuid}))];[...c.map(o=>({label:`${o.hora_inicio} - ${o.hora_fin} / ${W(o.dias)}`,value:o.uuid}))];const q=[...m.map(o=>({label:`${o.nombres} ${o.ape_paterno} ${o.ape_materno}`,value:o.uuid}))],N=[...g.map(o=>({label:o.nombre,value:o.uuid}))],F=o=>{o.target.value!=""&&o.target.value!=null&&(f({...a,tipoCarre:u.find(A=>A.uuid==o.target.value).tipo_carrera,carrera:o.target.value}),v(o.target.value).then(A=>{b([...A.map(w=>({label:w.nombre,value:w.uuid}))]),x()}))};return s(P,{gap:3,children:[s(z,{sx2:G,children:[s(S,{sx:H,children:[e(ve,{required:!0,label:"Sede",name:"sede",value:a.sede,onChange:d,opts:N}),e(T,{required:!0,label:"Responsable",name:"responsableUuid",value:a.responsableUuid,onChange:d,options:q})]}),e(S,{sx:{...H,alignItems:"center"},children:a.isCarrera?e(T,{required:!0,label:"Carrera",name:"carrera",value:a.carrera,onChange:F,options:D}):e(T,{required:!0,label:"Especialidad",name:"especialidad",value:a.especialidad,onChange:d,options:M})})]}),e(z,{sx2:G,children:e(Me,{formGroup:r})})]})},G={flex:1,borderRadius:2,p:4,display:"flex",flexDirection:"column",boxSizing:"border-box"},H={flex:1,display:"flex",flexDirection:"row",gap:"0px 24px;",flexWrap:"wrap"},I=["Datos del Estudiante","Datos academicos"],_e=de(ge)(({theme:r})=>({[`&.${k.alternativeLabel}`]:{},[`&.${k.active}`]:{[`& .${k.line}`]:{backgroundColor:"#FED800"}},[`&.${k.completed}`]:{[`& .${k.line}`]:{backgroundColor:"#FED800"}},[`& .${k.line}`]:{height:3,border:0,backgroundColor:r.palette.mode==="dark"?r.palette.grey[800]:"#eaeaf0",borderRadius:1}})),mo=({toggleDrawer:r})=>{const[t,a]=h.useState(0),[f,d]=h.useState(new Set),{user:u,isLoading:p,token:v}=ce(l=>l.user),[c,g]=h.useState(!1),x=()=>{g(!0)},i=()=>{g(!1)},m=ue(),y={token:v,id:u.uuid,tipo:"nuevo",nombres:"",ape_paterno:"",ape_materno:"",celular:"",celReferencia:"",correo:"",edad:"",dni:"",sexo:"",grado:"",departamento:"",provincia:"",distrito:"",direccion:"",residencia:"",carrera:"",isCarrera:!0,especialidad:"",modulos:[],horario:"",inicio:"",sede:u.sede.uuid,modo:"",pendiente:!0,tipoPago:"",nroDocu:"",entidad:"",monto:0,imgDoc:null,hora_inicio:"00:00",hora_fin:"00:00",turno:"",dias:[],edit:!1,horaPago:"00:00",tipoCarre:"semestral",error:!1,fechaPago:"",responsableUuid:u.uuid},n=me(y),{formState:b,setFormState:M,onInputChange:D,onSubmit:q,onImageChange:N,onFill:F,onAceptFil:o,departamentos:A,provincias:R,distritos:w,getListDistritos:K,getListProvincias:V,grados:X,tipoPago:Be,loading:Y,onSubmitEspe:Pe,onInitial:qe,onTraslado:Z,getListCareers:ee}=n;pe();const oe={0:e(Se,{tipo:!0,requiredUbi:!0,setFormState:M,formCareer:n,formState:b,onInputChange:D,onFill:F,onAceptFil:o,isLoading:p,ubicacion:{departamentos:A,distritos:w,provincias:R,getListDistritos:K,getListProvincias:V},grados:X,loading:Y}),1:e(Fe,{formCareer:n,handleOpenAdd:x})},te=l=>!1,j=l=>f.has(l),re=()=>{a(0)},ae=l=>{if(l.preventDefault(),!b.error)if(t===I.length-1)Z(()=>{m("/home/matricula/listado")});else{let C=f;j(t)&&(C=new Set(C.values()),C.delete(t)),a(E=>E+1),d(C)}},ie=()=>{a(l=>l-1)},O=async l=>{D({target:{name:"horario",value:`${b.hora_inicio} - ${b.hora_fin} / ${W(b.dias.map(C=>dias[C]))}`}}),l()};return h.useEffect(()=>{ee()},[]),e(fe,{title:"Importar matricula",toggleDrawer:r,children:s(S,{sx:{width:"100%"},children:[e(be,{activeStep:t,alternativeLabel:!0,connector:e(_e,{}),children:I.map((l,C)=>{const E={width:"100px",height:"100px"},ne={};return j(C)&&(E.completed=!1),e(xe,{...E,children:e(Ce,{...ne,children:l})},l)})}),t===I.length?s(h.Fragment,{children:[e(Q,{sx:{mt:2,mb:1},children:"All steps completed - you're finished"}),s(S,{sx:{display:"flex",flexDirection:"row",py:2},children:[e(S,{sx:{flex:"1 1 auto"}}),e(_,{variant:"contained",onClick:re,children:"Reset"})]})]}):s("form",{style:{paddingTop:"24px"},onSubmit:ae,children:[oe[t],s(S,{sx:{display:"flex",flexDirection:"row",pt:2},children:[t!=0&&e(_,{color:"inherit",variant:"contained",disabled:t===0,onClick:ie,sx:{mr:1},children:"Atras"}),e(S,{sx:{flex:"1 1 auto"}}),te(),e(Ie,{title:b.error?"Corrija todos los errores":"",children:t===I.length-1?e(Te,{type:"submit",color:"primary",variant:"contained",children:"Terminar"}):e(_,{type:"submit",color:"primary",variant:"contained",children:"Siguiente"})})]})]}),e(he,{formState:b,handleClose:i,isLoading:!1,onEdit:O,onInputChange:D,onSubmit:O,open:c})]})})};export{mo as default};
