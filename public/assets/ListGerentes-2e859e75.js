import{b as e,y as T,B as E,j as y,l as x,t as D,e as _,r as g,g as A,ai as W,aj as k,ae as q,s as I,o as M,q as U}from"./index-b05c3593.js";import{P as z}from"./Page-87bac860.js";import{T as H}from"./TableCRUDMini-8ef25830.js";import{C as J}from"./CustomActionCRUD-56f80e1a.js";/* empty css               */import{b as K,c as Q,M as V,D as X,S as Y,C as Z,d as ee}from"./TextfieldsTools-ddad1e93.js";import{L as R}from"./LoadingButton-caa486e8.js";import{C as te}from"./CustomSelectSearchLabel-0730f57a.js";import{g as re}from"./GlobalAlerts-e291f7f6.js";import{D as ae}from"./Delete-e33b6966.js";import"./RowCRUD-b35830b8.js";import"./TableRow-52fc41de.js";import"./TableContainer-10b5223d.js";import"./TableHead-f4539647.js";import"./SelectCustom-ab67c468.js";import"./MenuItem-d8a67f6c.js";import"./CircularProgress-eeae7465.js";import"./Autocomplete-7a426b1a.js";import"./Tooltip-8a46e05f.js";const ne=({formSecretary:s,open:t,handleClose:r,isLoading:d,selected:c})=>{const{onInputChange:n,formState:o,onSubmit:u,sedes:p,editSecretary:C,setFormState:m}=s,b=p.map(S=>({label:S.nombre,value:S.uuid}));return e(T,{open:t,handleClose:r,title:c?"Editar Secretaria":"Agregar Gerente",children:e(E,{sx:{px:3,pb:3},children:y("form",{style:{flex:1},onSubmit:S=>{S.preventDefault(),c||u(r)},children:[y(x,{flexDirection:"row",gap:3,children:[y(E,{sx:oe,children:[e(K,{formState:o,onInputChange:n,setFormState:m}),e(Q,{formState:o,onInputChange:n,setFormState:m}),e(V,{formState:o,onInputChange:n,setFormState:m}),e(X,{formState:o,onInputChange:n,setFormState:m})]}),e(x,{children:y(x,{children:[e(Y,{formState:o,onInputChange:n,options:b}),e(Z,{formState:o,onInputChange:n,setFormState:m}),e(ee,{formState:o,onInputChange:n,setFormState:m})]})})]}),c?e(R,{fullWidth:!0,loading:d,type:"submit",variant:"contained",color:"primary",sx:{mt:2,alignSelf:"flex-end"},children:"Editar Secretaria"}):e(R,{fullWidth:!0,loading:d,type:"submit",variant:"contained",color:"primary",sx:{mt:2,alignSelf:"flex-end"},children:"Agregar Gerente"})]})})})},oe={flex:1,display:"flex",flexDirection:"column",gap:"0px 24px",flexWrap:"wrap"},se=async(s,t)=>{try{return(await D.get(`/gerente/list-by-sede?sede=${t}`,{headers:{"x-token":s}})).data}catch(r){throw r}},ie=async(s,t)=>{try{return(await D.delete(`/gerente/${t}`,{headers:{"x-token":s}})).data}catch(r){throw r}},ce=async({token:s,dni:t,nombres:r,ape_paterno:d,ape_materno:c,celular:n,correo:o,sede:u})=>{try{return(await D.post("/gerente",{dni:t,nombres:r,apePaterno:d,apeMaterno:c,celular:n,correo:o,codSede:u},{headers:{"x-token":s}})).data}catch(p){throw p}},le=(s={})=>{const t=_(),[r,d]=g.useState(s),[c,n]=g.useState([]),{sedes:o}=A(i=>i.utilities),{token:u}=A(i=>i.user),{createAlert:p,editAlert:C,deleteAlert:m}=re();return{...r,formState:r,setFormState:d,onInputChange:({target:i})=>{const{name:a,value:h}=i;d({...r,[a]:h})},onResetForm:()=>{d(s)},onSubmit:async i=>{p("este gerente","Gerente Registrado",async()=>{try{t(I());const a=await ce({...r,token:u});n([...c,a.secretary]),t(M())}catch(a){throw a}},i)},data:c,sedes:o,getListGerentes:async i=>{try{t(W());const a=await se(u,i);return n(a||[]),t(k()),a||[]}catch(a){q(a),t(k())}},OndeleteGerente:async(i,a)=>{m("este gerente","Gerente Eliminado",async()=>{try{t(I());const h=await ie(u,i);n([...c.filter(G=>G.uuid!==h.uuid)]),t(M())}catch(h){throw h}},a)}}},Me=({toggleDrawer:s})=>{const[t,r]=g.useState([]),[d,c]=g.useState(null),{isLoading:n,token:o,user:u}=A(l=>l.user),[p,C]=g.useState(!1),b=le({token:o,ape_materno:"",ape_paterno:"",dni:"",nombres:"",celular:"",correo:"",sede:""}),{formState:v,setFormState:S,onResetForm:L,data:w,getListGerentes:i,OndeleteGerente:a,sedes:h}=b,G=[...h.map(l=>({label:l.nombre,value:l.uuid}))],[j,B]=g.useState(h[0].uuid),N=({target:l})=>{l.value!=""&&B(l.value)},O=l=>l.map(f=>({uuid:f.uuid,nombres:`${f.nombres} ${f.ape_paterno} ${f.ape_materno}`,dni:f.dni,correo:f.correo,celular:f.celular})),P=()=>{C(!0)},F=()=>{L(),C(!1),c(null)},$=[e(J,{action:l=>{a(t[l].uuid,F)},children:e(ae,{})})];return g.useEffect(()=>{},[]),g.useEffect(()=>{r(O(w))},[w]),e(z,{title:"Gerentes",Actions:e(U,{sx:{width:"100px"},variant:"contained",color:"primary",onClick:P,children:" Agregar"}),toggleDrawer:s,children:y(x,{gap:2,children:[e(x,{flexDirection:"row",gap:3,justifyContent:"space-between",alignItems:"center",width:200,children:e(te,{required:!0,label:"Sede",name:"sede",value:j,onChange:N,options:G})}),e(H,{data:t,headers:me,dataTypes:de,extraActions:$}),e(ne,{formSecretary:b,handleClose:F,isLoading:n,open:p,selected:d})]})})},de=["dni","nombres","celular","correo"],me=[{name:"DNI",align:"center"},{name:"Nombres",align:"center"},{name:"Celular",align:"center"},{name:"Correo",align:"center"}];export{Me as default};
