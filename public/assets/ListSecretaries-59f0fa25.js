import{e as P,r as S,g as D,ai as W,az as $,aj as B,ae as q,s as L,aA as U,o as F,aB as z,b as e,y as G,B as I,j as g,l as C,q as H}from"./index-b05c3593.js";import{P as J}from"./Page-87bac860.js";import{T as K}from"./TableCRUDMini-8ef25830.js";import{C as Q}from"./CustomActionCRUD-56f80e1a.js";import{g as V}from"./GlobalAlerts-e291f7f6.js";import{C as X}from"./CustomSelectSearchLabel-0730f57a.js";/* empty css               */import{b as Y,c as Z,M as ee,D as te,S as re,C as ae,d as oe}from"./TextfieldsTools-ddad1e93.js";import{T as se}from"./Tooltip-8a46e05f.js";import{L as M}from"./LoadingButton-caa486e8.js";import{D as ne}from"./Delete-e33b6966.js";import"./RowCRUD-b35830b8.js";import"./TableRow-52fc41de.js";import"./TableContainer-10b5223d.js";import"./TableHead-f4539647.js";import"./Autocomplete-7a426b1a.js";import"./SelectCustom-ab67c468.js";import"./MenuItem-d8a67f6c.js";import"./CircularProgress-eeae7465.js";const ie=(h={})=>{const r=P(),[l,m]=S.useState(h),[p,s]=S.useState([]),{sedes:a}=D(o=>o.utilities),{token:i}=D(o=>o.user),{createAlert:y,editAlert:b,deleteAlert:c}=V();return{...l,formState:l,setFormState:m,onInputChange:({target:o})=>{const{name:t,value:u}=o;m({...l,[t]:u})},onResetForm:()=>{m(h)},onSubmit:async o=>{y("esta secretaria","Secretaria Registrada",async()=>{try{r(L());const t=await z({...l,token:i});s([...p,t.secretary]),r(F())}catch(t){throw t}},o)},data:p,sedes:a,getListSecretaries:async o=>{try{r(W());const t=await $(i,o);return s(t||[]),r(B()),t||[]}catch(t){q(t),r(B())}},OnEditSecretary:async(o,t)=>{b("esta secretaria",async()=>{try{r(L()),r(F())}catch(u){throw u}},t)},OndeleteSecretary:async(o,t)=>{c("esta secretaria","Secretaria Eliminada",async()=>{try{r(L());const u=await U(i,o);s([...p.filter(A=>A.uuid!==u.uuid)]),r(F())}catch(u){throw u}},t)}}},ce=({formSecretary:h,open:r,handleClose:l,isLoading:m,selected:p})=>{const{onInputChange:s,formState:a,onSubmit:i,sedes:y,editSecretary:b,setFormState:c}=h,{user:x}=D(d=>d.user),v=y.map(d=>({label:d.nombre,value:d.uuid}));return e(G,{open:r,handleClose:l,title:p?"Editar Secretaria":"Agregar Secretaria",children:e(I,{sx:{px:3,pb:3},children:g("form",{style:{flex:1},onSubmit:d=>{d.preventDefault(),i(l)},children:[g(C,{flexDirection:"row",gap:3,children:[g(I,{sx:le,children:[e(Y,{formState:a,onInputChange:s,setFormState:c}),e(Z,{formState:a,onInputChange:s,setFormState:c}),e(ee,{formState:a,onInputChange:s,setFormState:c}),e(te,{formState:a,onInputChange:s,setFormState:c})]}),e(C,{children:g(C,{children:[e(re,{formState:a,onInputChange:s,options:v,disabled:x.rol==null}),e(ae,{formState:a,onInputChange:s,setFormState:c}),e(oe,{formState:a,onInputChange:s,setFormState:c})]})})]}),e(se,{title:a.error?"Corrija todos los errores":"",children:p?e(M,{fullWidth:!0,disabled:a.error,loading:m,type:"submit",variant:"contained",color:"primary",sx:{mt:2,alignSelf:"flex-end"},children:"Editar Secretaria"}):e(M,{fullWidth:!0,loading:m,disabled:a.error,type:"submit",variant:"contained",color:"primary",sx:{mt:2,alignSelf:"flex-end"},children:"Agregar Secretaria"})})]})})})},le={flex:1,display:"flex",flexDirection:"column",gap:"0px 24px",flexWrap:"wrap"},Ie=({toggleDrawer:h})=>{const[r,l]=S.useState([]),[m,p]=S.useState(null),{isLoading:s,token:a,user:i}=D(n=>n.user),[y,b]=S.useState(!1),c={token:a,ape_materno:"",ape_paterno:"",dni:"",nombres:"",celular:"",correo:"",sede:i.rol?"":i.sede.uuid},x=ie(c),{formState:v,setFormState:O,onResetForm:d,data:w,getListSecretaries:E,OndeleteSecretary:o,sedes:t}=x,u=[...t.map(n=>({label:n.nombre,value:n.uuid}))],[A,R]=S.useState(i.rol?t[0].uuid:i.sede.uuid),T=({target:n})=>{n.value!=""&&(E(n.value),R(n.value))},N=n=>n.map(f=>({uuid:f.uuid,nombres:`${f.nombres} ${f.ape_paterno} ${f.ape_materno}`,dni:f.dni,correo:f.correo,celular:f.celular})),k=()=>{b(!0)},j=()=>{d(),b(!1),p(null)},_=[e(Q,{action:n=>{o(r[n].uuid,j)},children:e(ne,{})})];return S.useEffect(()=>{E(A)},[]),S.useEffect(()=>{l(N(w))},[w]),g(J,{title:"Secretarias",Actions:e(H,{sx:{width:"100px"},variant:"contained",color:"primary",onClick:k,children:" Agregar"}),toggleDrawer:h,children:[g(C,{gap:2,children:[e(C,{flexDirection:"row",gap:3,justifyContent:"space-between",alignItems:"center",width:200,children:e(X,{required:!0,label:"Sede",name:"sede",value:A,onChange:T,options:u})}),e(K,{data:r,headers:ue,dataTypes:de,extraActions:_})]}),e(ce,{formSecretary:x,handleClose:j,isLoading:s,open:y,selected:m})]})},de=["dni","nombres","celular","correo"],ue=[{name:"DNI",align:"center"},{name:"Nombres",align:"center"},{name:"Celular",align:"center"},{name:"Correo",align:"center"}];export{Ie as default};
