import{e as z,r as i,g as I,ai as j,aj as _,ae as k,s as x,o as w,j as B,b as u,q as G,l as K}from"./index-b05c3593.js";import{C as J}from"./CustomActionCRUD-56f80e1a.js";import{A as Q}from"./AddSchedule-c46ae1fc.js";import{g as W,c as X,d as Y,e as Z}from"./schedule.service-5bfabb81.js";import{g as ee}from"./GlobalAlerts-e291f7f6.js";import{a as te}from"./careers.service-c54b684b.js";import{P as ae}from"./Page-87bac860.js";import{T as oe}from"./TableCRUDMini-8ef25830.js";import{g as re}from"./utilities-59a1cf49.js";import{C as se}from"./CaptionBox-53db12e8.js";import{E as ie}from"./Edit-18203eee.js";import{D as ne}from"./Delete-e33b6966.js";/* empty css               */import"./ToggleButtonGroup-67aa73a9.js";import"./LoadingButton-caa486e8.js";import"./CircularProgress-eeae7465.js";import"./RowCRUD-b35830b8.js";import"./TableRow-52fc41de.js";import"./TableContainer-10b5223d.js";import"./TableHead-f4539647.js";import"./Tooltip-8a46e05f.js";import"./Info-b8afdcbc.js";const ce=(g={})=>{const r=z(),[s,l]=i.useState(g),[h,p]=i.useState([]),{sedes:f}=I(e=>e.utilities),{token:m}=I(e=>e.user),{createAlert:A,editAlert:D,deleteAlert:b}=ee(),[E,F]=i.useState([]);return{...s,formState:s,setFormState:l,onInputChange:({target:e})=>{const{name:a,value:o}=e;l({...s,[a]:o})},onResetForm:()=>{l(g)},onSubmit:async e=>{A("este horario","Horario Registrado",async()=>{try{r(x());const a=await X({...s,token:m,horaInicio:s.hora_inicio,horaFin:s.hora_fin,dias:s.dias.map((o,n)=>N[o])});p([...h,a]),r(w())}catch(a){throw a}},e)},onDelete:async(e,a)=>{b("este horario","Horario Eliminado",async()=>{try{r(x());const o=await Y(m,e);p([...h.filter(n=>n.uuid!==e)]),r(w())}catch(o){throw o}},a)},onEdit:async(e,a)=>{D("este horario",async()=>{try{r(x());const o=await Z(e,{...s,token:m,horaInicio:s.hora_inicio,horaFin:s.hora_fin,dias:s.dias.map((n,y)=>N[n])});p([...h.map(n=>n.uuid==o.uuid?{...n,hora_inicio:o.hora_inicio,hora_fin:o.hora_fin,dias:o.dias}:n)]),r(w())}catch(o){throw o}},a)},carreras:E,getListCareers:async()=>{try{r(j());const e=await te(m,s.sede);return F(e),r(_()),e}catch(e){r(_()),k(e)}},sedes:f,getListSchedules:async e=>{try{r(j());const a=await W(m);return p(a),r(_()),a}catch(a){k(a),r(_())}},schedules:h}},N={0:"Lun",1:"Mar",2:"Mie",3:"Jue",4:"Vie",5:"Sab",6:"Dom"},Te=({toggleDrawer:g})=>{const{isLoading:r,token:s,user:l}=I(t=>t.user),h=t=>{const d=[];return t.map(c=>{d.push({uuid:c.uuid,horaInicio:c.hora_inicio,horaFin:c.hora_fin,dias:re(c.dias),turno:c.turno})}),d},p={token:s,uuid:"",sede:l.rol?"":l.sede.uuid,hora_inicio:"00:00",hora_fin:"00:00",turno:"",dias:[]},{formState:f,onInputChange:m,onSubmit:A,onResetForm:D,onDelete:b,onEdit:E,setFormState:F,schedules:S,getListCareers:O,getListSchedules:R,carreras:L,sedes:v}=ce(p),[H,C]=i.useState(!1),e=[...L.map(t=>({label:t.nombre,value:t.uuid}))],a=[...v.map(t=>({label:t.nombre,value:t.uuid}))];i.useState(a[0].value);const[o,n]=i.useState(L.length!=0?e[0].value:""),[y,M]=i.useState([]),[P,U]=i.useState(null),V=()=>{C(!0)},T=()=>{D(),C(!1)},q=t=>{const d=S.find(c=>c.uuid==y[t].uuid);F({...f,uuid:d.uuid,hora_inicio:d.hora_inicio,hora_fin:d.hora_fin,dias:d.dias.map(c=>he[c])}),U(d.uuid),C(!0)},$=[u(J,{action:t=>{q(t)},children:u(ie,{})}),u(J,{action:t=>{b(y[t].uuid,T)},children:u(ne,{})})];return i.useEffect(()=>{R(o).then(t=>{M(h(t))})},[]),i.useEffect(()=>{M(h(S))},[S]),B(ae,{toggleDrawer:g,Actions:u(G,{sx:{width:"100px"},variant:"contained",color:"primary",onClick:V,children:" Agregar"}),title:"Horarios",children:[B(K,{gap:3,height:"100%",maxHeight:"100%",children:[u(oe,{data:y,headers:ue,dataTypes:de,extraActions:$}),u(Q,{selected:P,onEdit:E,onSubmit:A,formState:f,onInputChange:m,open:H,handleClose:T,isLoading:r})]}),u(se,{text:"Registre horarios para los diferentes grupos. Estos horarios apareceran en todas las sedes"})]})},de=["horaInicio","horaFin","dias"],ue=[{name:"Hora de Inicio",align:"center"},{name:"Hora de Fin",align:"center"},{name:"Dias",align:"center"}],he={Lun:0,Mar:1,Mie:2,Jue:3,Vie:4,Sab:5,Dom:6};export{Te as default};
